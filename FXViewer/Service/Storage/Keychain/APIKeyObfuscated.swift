//
//  APIKeyObfuscated.swift
//  FXViewer
//
//  Created by Nik Dub on 9/20/25.
//

import Foundation

struct APIKeyObfuscated {
    private static let mask: UInt8 = 0x5A

    static var obfuscatedBytes: [UInt8]  = [
        0x03, 0x30, 0x1F, 0x6E, 0x03, 0x0E, 0x1C, 0x33,
        0x15, 0x0D, 0x10, 0x33, 0x17, 0x1D, 0x14, 0x31,
        0x03, 0x30, 0x36, 0x37, 0x15, 0x0E, 0x13, 0x6A,
        0x14, 0x0E, 0x1F, 0x6B, 0x03, 0x0E, 0x14, 0x33,
        0x03, 0x20, 0x10, 0x32, 0x15, 0x0E, 0x0B, 0x20,
        0x17, 0x1D, 0x0B, 0x6F, 0x17, 0x1E, 0x32, 0x30,
        0x00, 0x1D, 0x0F, 0x20, 0x14, 0x1E, 0x03, 0x69,
        0x15, 0x0E, 0x18, 0x32, 0x14, 0x30, 0x00, 0x37,
        0x14, 0x20, 0x0C, 0x33, 0x14, 0x0E, 0x36, 0x31,
        0x00, 0x1E, 0x31, 0x6A, 0x03, 0x0D, 0x0B, 0x2D,
        0x03, 0x0E, 0x10, 0x32, 0x17, 0x0B, 0x67, 0x67

    ]
    
    static func reveal(_ bytesArray: [UInt8]) -> String? {
        let deXOR = bytesArray.map { $0 ^ mask }
        guard let base64Str = String(bytes: deXOR, encoding: .utf8),
              let keyData = Data(base64Encoded: base64Str),
              let key = String(data: keyData, encoding: .utf8) else {
            return nil
        }
        return key
    }
    
    static func clear() {
        APIKeyObfuscated.obfuscatedBytes = []
    }
}
